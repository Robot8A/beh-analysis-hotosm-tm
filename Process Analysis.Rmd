---
title: "Process Analysis"
output:
  pdf_document: default
  html_notebook: default
---

This is R Notebook present a process analysis of 746 completed, fully validated, and archived projects in the HOT Tasking Manager (HOT-TM) over the past two years.
The process is analised from four perspectives: 

1) [Control flow](#controlflow)
2) Time
3) Organisation
4) Outcome

Process discovery was performed using bupaR, a suite of open-source R packages for business process data analysis.
```{r}
library(bupaverse)
```
# Read event data
The log containing only initial tasks ("initial_tasks.csv") is used in  1) Control flow, 2) Time, 3) Organisation sections, where a clean view of the process is required.
```{r}
event_log_df <- read.csv("initial_tasks.csv", stringsAsFactors = FALSE, sep = ",")
event_log_df <- event_log_df %>%
  convert_timestamps(columns = c("start", "complete"), format = ymd_hms) %>%
  activitylog(case_id = "taskId", activity_id = "action", resource_id = "actionBy", timestamps = c("start", "complete"))
```

# Control flow {#controlflow}
Absolute frequency of activities in the eventlog.
```{r}
event_log_df %>% activity_frequency("activity")
```
Activity presence shows in what percentage of cases an activity is present. 
```{r}
event_log_df %>% activity_presence()
```
The start of cases can be described using the start_activities function.
```{r}
event_log_df %>%
    start_activities("activity")
```
The end_activities function describes the end of cases
```{r}
event_log_df %>%
    end_activities("activity")
```

In the frequency process map, nodes represent the absolute number of activity instance executions and edges represent the absolute number of times source and target activities were executed directly following each other.
To provide a clear process map, the event log was previously filter using filter_trace_frequency(). Setting percentage = 0.95 selects at least 95% of the cases, starting with those that have the highest frequency.

```{r}
tmp <- event_log_df %>% filter_trace_frequency(percentage = 0.95)
tmp %>%  process_map(frequency("absolute"))
```

trace_explorer() with coverage argument n_traces = 3 shows the 3 most frequent in the event log.
```{r}
event_log_df %>%
    trace_explorer(n_traces = 3, show_labels = FALSE, coverage_labels = c("relative"))
```





